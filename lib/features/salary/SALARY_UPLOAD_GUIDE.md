# دليل رفع بيانات المرتبات من ملف Excel

## نظرة عامة
هذه الميزة تسمح للأدمن برفع بيانات المرتبات الشهرية لجميع الموظفين من ملف Excel واحد.

## تنسيق ملف Excel المطلوب

يجب أن يحتوي ملف Excel على الأعمدة التالية بالترتيب:

| رقم العمود | اسم العمود | الوصف |
|-----------|-----------|-------|
| 0 | employeeUid | معرف الموظف الفريد (UID) |
| 1 | pharmacyCode | كود الصيدلية |
| 2 | pharmacyName | اسم الصيدلية |
| 3 | acc | ACC |
| 4 | nameEnglish | الاسم بالإنجليزية |
| 5 | nameArabic | الاسم بالعربية |
| 6 | hourlyRate | الساعة الشهرية (مبلغ) |
| 7 | hoursWorked | نظام العمل بالساعات |
| 8 | basicSalary | المرتب الأساسي |
| 9 | incentive | الحافز |
| 10 | additional | الإضافي |
| 11 | quarterlySalesIncentive | حوافز مبيعات تبديل ربع سنوي |
| 12 | workBonus | مكافأة عن العمل |
| 13 | administrativeBonus | المكافآت الإدارية |
| 14 | transportAllowance | بدل مواصلات |
| 15 | employerShare | صاحب عمل |
| 16 | eideya | العيديات |
| 17 | hourlyDeduction | الخصم بالساعات |
| 18 | penalties | جزاءات |
| 19 | pharmacyCodeDeduction | خصم من كود السحب الدوائي |
| 20 | visaDeduction | خصم مصاريف فتح فيزا |
| 21 | advanceDeduction | خصم سلف |
| 22 | quarterlyShiftDeficitDeduction | خصم عجز الشيفتات الربع سنوي |
| 23 | insuranceDeduction | خصم تأمينات |
| 24 | netSalary | ما يستحقه العامل |
| 25 | remainingAdvance | المتبقي من السلف على العامل |

## ملاحظات مهمة

1. **صف العناوين**: الصف الأول في الملف يجب أن يحتوي على عناوين الأعمدة وسيتم تجاهله تلقائياً
2. **الصفوف الفارغة**: سيتم تجاهل أي صفوف فارغة تلقائياً
3. **القيم المفقودة**: أي قيمة مفقودة سيتم استبدالها بـ "0"
4. **تنسيق الملف**: يجب أن يكون الملف بصيغة `.xlsx` أو `.xls`
5. **التحديث**: إذا كانت بيانات الشهر موجودة مسبقاً، سيتم تحديثها

## كيفية الاستخدام

1. افتح التطبيق وانتقل إلى قسم المرتبات
2. اضغط على زر "رفع بيانات المرتبات"
3. اختر الشهر المطلوب
4. اختر ملف Excel
5. أضف ملاحظات (اختياري)
6. اضغط على "رفع البيانات"

## البنية في Firestore

```
salaries/
  └── {YYYY-MM}/                    // مثال: "2024-11"
      ├── monthKey: "2024-11"
      ├── monthName: "نوفمبر 2024"
      ├── year: 2024
      ├── month: 11
      ├── uploadedAt: Timestamp
      ├── uploadedBy: "admin_uid"
      ├── employeeCount: 50
      ├── notes: "ملاحظات اختيارية"
      └── employees/               // Sub-collection
          └── {employee_uid}/
              ├── employeeUid
              ├── pharmacyCode
              ├── ... (جميع البيانات)
```

## مثال على ملف Excel

يمكنك تحميل ملف Excel نموذجي من [هنا](#) أو إنشاء ملف بالتنسيق المذكور أعلاه.

## معالجة الأخطاء

- إذا كان الملف فارغاً أو غير صالح، ستظهر رسالة خطأ
- إذا لم تكن هناك بيانات صالحة في الملف، ستظهر رسالة خطأ
- سيتم تجاهل أي صفوف بها أخطاء والمتابعة مع الصفوف الصحيحة

## الصلاحيات

- فقط المستخدمون بصلاحية `Admin` يمكنهم رفع بيانات المرتبات
- جميع المستخدمين الآخرين يمكنهم فقط عرض مرتباتهم الخاصة

